/*! Rappid v1.7.1 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2016-03-03 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


joint.dia.Paper.prototype.toSVG=function(a,b){function c(){return(new XMLSerializer).serializeToString(g).replace(/&nbsp;/g,"Â ")}function d(a){var b=V(m.shift());if(!b)return a();var c=b.attr("xlink:href")||b.attr("href");joint.util.imageToDataUri(c,function(c,e){b.attr("xlink:href",e),d(a)})}b=b||{};var e=V(this.viewport).attr("transform");V(this.viewport).attr("transform","");var f=this.getContentBBox(),g=this.svg.cloneNode(!0);V(this.viewport).attr("transform",e||""),g.removeAttribute("style"),b.preserveDimensions?V(g).attr({width:f.width,height:f.height}):V(g).attr({width:"100%",height:"100%"}),V(g).attr("viewBox",f.x+" "+f.y+" "+f.width+" "+f.height);for(var h=document.styleSheets.length,i=[],j=h-1;j>=0;j--)i[j]=document.styleSheets[j],document.styleSheets[j].disabled=!0;var k={};$(this.svg).find("*").each(function(a){var b=window.getComputedStyle(this,null),c={};_.each(b,function(a){c[a]=b.getPropertyValue(a)}),k[a]=c}),h!=document.styleSheets.length&&_.each(i,function(a,b){document.styleSheets[b]=a});for(var j=0;h>j;j++)document.styleSheets[j].disabled=!1;var l={};$(this.svg).find("*").each(function(a){var b=window.getComputedStyle(this,null),c=k[a],d={};_.each(b,function(a){b.getPropertyValue(a)!==c[a]&&(d[a]=b.getPropertyValue(a))}),l[a]=d});var m=[];return $(g).find("*").each(function(a){$(this).css(l[a]),"image"===this.tagName.toLowerCase()&&m.push(this)}),b.convertImagesToDataUris&&m.length?void d(function(){a(c())}):a(c())},joint.dia.Paper.prototype.openAsSVG=function(a){var b="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",c=_.uniqueId("svg_output");this.toSVG(function(a){var d=window.open("",c,b),e="data:image/svg+xml,"+encodeURIComponent(a);d.document.write('<img src="'+e+'" style="max-height:100%" />')},_.extend({convertImagesToDataUris:!0},a))};